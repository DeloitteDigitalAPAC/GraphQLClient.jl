<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · GraphQLClient.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://deloittedigitalapac.github.io/GraphQLClient.jl/stable/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><script src="../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>GraphQLClient.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Key-Features-of-GraphQLClient"><span>Key Features of GraphQLClient</span></a></li><li><a class="tocitem" href="#Basic-Usage"><span>Basic Usage</span></a></li><li><a class="tocitem" href="#Use-with-Microservices-Architectures"><span>Use with Microservices Architectures</span></a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="client/">Client</a></li><li><a class="tocitem" href="operations/">Operations</a></li><li><a class="tocitem" href="struct_types_usage/">Struct Types Usage</a></li><li><a class="tocitem" href="type_introspection/">Type Introspection</a></li><li><a class="tocitem" href="low_level_execution/">Low Level Execution</a></li><li><a class="tocitem" href="limitations/">Current Limitations</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="public/">Public</a></li><li><a class="tocitem" href="private/">Private</a></li></ul></li><li><a class="tocitem" href="contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DeloitteDigitalAPAC/GraphQLClient.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="GraphQLClient.jl"><a class="docs-heading-anchor" href="#GraphQLClient.jl">GraphQLClient.jl</a><a id="GraphQLClient.jl-1"></a><a class="docs-heading-anchor-permalink" href="#GraphQLClient.jl" title="Permalink"></a></h1><p><em>A Julia GraphQL client for seamless integration with a server</em></p><p>This package is intended to make connecting to and communicating with GraphQL servers easy whilst integrating easily with the wider Julia ecosystem.</p><p>What is GraphQL? It is a <em>&quot;query language for APIs and a runtime for fulfilling those queries with your existing data&quot;</em>. For further information, see <a href="https://graphql.org">https://graphql.org</a>.</p><h2 id="Key-Features-of-GraphQLClient"><a class="docs-heading-anchor" href="#Key-Features-of-GraphQLClient">Key Features of GraphQLClient</a><a id="Key-Features-of-GraphQLClient-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Features-of-GraphQLClient" title="Permalink"></a></h2><ul><li><strong>Querying</strong>, <strong>mutating</strong> and <strong>subscribing</strong> without manual writing of query strings</li><li><code>@gql_str</code> non-standard string literal which <strong>validates a query string at compile time</strong></li><li>Deserializing responses directly using <strong>StructTypes</strong></li><li>Type stable querying</li><li><strong>Construction of Julia types</strong> from GraphQL objects</li><li>Using <strong>introspection</strong> to help with querying</li></ul><div class="admonition is-info"><header class="admonition-header">There is plenty more to come</header><div class="admonition-body"><p>GraphQL is a featureful language, and we are working to bring in new features to meet all of the specification. Please see <a href="https://github.com/DeloitteDigitalAPAC/GraphQLClient.jl/issues">the issues</a>, let us know what you&#39;d like us to be working on and contribute!</p></div></div><h2 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h2><h3 id="Connecting-to-a-server"><a class="docs-heading-anchor" href="#Connecting-to-a-server">Connecting to a server</a><a id="Connecting-to-a-server-1"></a><a class="docs-heading-anchor-permalink" href="#Connecting-to-a-server" title="Permalink"></a></h3><p>A client can be instantiated by using the <code>Client</code> type</p><pre><code class="language-julia-repl hljs">julia&gt; using GraphQLClient

julia&gt; client = Client(&quot;https://countries.trevorblades.com&quot;)
GraphQLClient Client
       endpoint: https://countries.trevorblades.com
    ws_endpoint: wss://countries.trevorblades.com</code></pre><p>This will, by default, use a query to introspect the server schema, populating several fields of the <code>Client</code> object which can then be used to help with querying.</p><p>We can also set a global client to be user by queries, mutations, subscriptions and introspection functions.</p><pre><code class="language-julia-repl hljs">julia&gt; global_graphql_client(Client(&quot;https://countries.trevorblades.com&quot;))
GraphQLClient Client
       endpoint: https://countries.trevorblades.com
    ws_endpoint: wss://countries.trevorblades.com</code></pre><p>And access the global client with the same function</p><pre><code class="language-julia-repl hljs">julia&gt; global_graphql_client()
GraphQLClient Client
       endpoint: https://countries.trevorblades.com
    ws_endpoint: wss://countries.trevorblades.com</code></pre><h3 id="Querying"><a class="docs-heading-anchor" href="#Querying">Querying</a><a id="Querying-1"></a><a class="docs-heading-anchor-permalink" href="#Querying" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">Using the global `Client`</header><div class="admonition-body"><p>In these examples, if the <code>client</code> argument is omitted, the global client will be used instead.</p></div></div><p>Now we have a <code>Client</code> object, we can query it with just a string</p><pre><code class="language-julia-repl hljs">julia&gt; response = GraphQLClient.execute(&quot;{countries{name}}&quot;)
GraphQLClient.GQLResponse{Any}
  data: Dict{String, Any}
          countries: Vector{Any}</code></pre><p>Or we can use the <a href="public/#GraphQLClient.@gql_str"><code>@gql_str</code></a> macro to perform some validation on the string first (at compile time)</p><pre><code class="language-julia-repl hljs">julia&gt; str = gql&quot;{countries{name}}&quot;
&quot;{countries{name}}&quot;

julia&gt; response = GraphQLClient.execute(str)
GraphQLClient.GQLResponse{Any}
  data: Dict{String, Any}
          countries: Vector{Any}</code></pre><p>Or we can query without having to type a full GraphQL query by hand at all! (Note, you should be able to test these queries for yourself, thanks to <a href="https://github.com/trevorblades/countries">https://github.com/trevorblades/countries</a>).</p><pre><code class="language-julia-repl hljs">julia&gt; response = query(client, &quot;countries&quot;)
GraphQLClient.GQLResponse{Any}
  data: Dict{String, Any}
    countries: Vector{Any}

julia&gt; response.data[&quot;countries&quot;]
250-element Vector{Any}:
 Dict{String, Any}...</code></pre><p>In this case, GraphQLClient used the introspected schema to determine what output fields were available (with some limitations to avoid recursing infinitely). Alternatively, we can specify what fields we would like to be returned</p><pre><code class="language-julia-repl hljs">julia&gt; response = query(client, &quot;countries&quot;, output_fields=&quot;name&quot;)
GraphQLClient.GQLResponse{Any}
  data: Dict{String, Any}
          country_names: Vector{Any}

julia&gt; response.data[&quot;countries&quot;]
250-element Vector{Any}:
 Dict{String, Any}(&quot;name&quot; =&gt; &quot;Andorra&quot;)
 Dict{String, Any}(&quot;name&quot; =&gt; &quot;United Arab Emirates&quot;)
 Dict{String, Any}(&quot;name&quot; =&gt; &quot;Afghanistan&quot;)
 Dict{String, Any}(&quot;name&quot; =&gt; &quot;Antigua and Barbuda&quot;)
⋮</code></pre><p>We can add arguments to the query</p><pre><code class="language-julia-repl hljs">julia&gt; query_args = Dict(&quot;filter&quot; =&gt; Dict(&quot;code&quot; =&gt; Dict(&quot;eq&quot; =&gt; &quot;AU&quot;))); # Filter for countries with code equal to AU

julia&gt; response = query(client, &quot;countries&quot;; query_args=query_args, output_fields=&quot;name&quot;);

julia&gt; response.data[&quot;countries&quot;]
1-element Vector{Any}:
 Dict{String, Any}(&quot;name&quot; =&gt; &quot;Australia&quot;)</code></pre><p>We can use an alias to change the name of either a query or a field in our results</p><pre><code class="language-julia-repl hljs">julia&gt; query_alias = Alias(&quot;country_names&quot;, &quot;countries&quot;);

julia&gt; response = query(client, query_alias, query_args=query_args, output_fields=&quot;name&quot;)
GraphQLClient.GQLResponse{Any}
  data: Dict{String, Any}
          country_names: Vector{Any}

julia&gt; response.data[&quot;country_names&quot;]
1-element Vector{Any}:
 Dict{String, Any}(&quot;name&quot; =&gt; &quot;Australia&quot;)</code></pre><p>We can define a <code>StructType</code> to deserialise the result into</p><pre><code class="language-julia-repl hljs">julia&gt; using StructTypes

julia&gt; struct CountryName
           name::String
       end

julia&gt; StructTypes.StructType(::Type{CountryName}) = StructTypes.OrderedStruct()

julia&gt; response = query(client, query_alias, Vector{CountryName}, query_args=query_args, output_fields=&quot;name&quot;)
GraphQLClient.GQLResponse{Vector{CountryName}}
  data: Dict{String, Union{Nothing, Vector{CountryName}}}
          country_names: Vector{CountryName}

julia&gt; response.data[&quot;country_names&quot;][1]
CountryName(&quot;Australia&quot;)</code></pre><p>Or we can use introspection to build the type automatically</p><pre><code class="language-julia-repl hljs">julia&gt; Country = GraphQLClient.introspect_object(client, &quot;Country&quot;)
┌ Warning: Cannot introspect field country on type State due to recursion of object Country
└ @ GraphQLClient ../GraphQLClient/src/type_construction.jl:75
┌ Warning: Cannot introspect field countries on type Continent due to recursion of object Country
└ @ GraphQLClient ../GraphQLClient/src/type_construction.jl:75
GraphQLClient.var&quot;##Country#604&quot;

julia&gt; response = query(client, query_alias, Vector{Country}, query_args=query_args, output_fields=&quot;name&quot;)
GQLResponse{Vector{GraphQLClient.var&quot;##Country#604&quot;}}
  data: Dict{String, Union{Nothing, Vector{GraphQLClient.var&quot;##Country#604&quot;}}}
          country_names: Vector{GraphQLClient.var&quot;##Country#604&quot;}

julia&gt; response.data[&quot;country_names&quot;][1]
Country
  name : Australia</code></pre><h3 id="Mutations"><a class="docs-heading-anchor" href="#Mutations">Mutations</a><a id="Mutations-1"></a><a class="docs-heading-anchor-permalink" href="#Mutations" title="Permalink"></a></h3><p>Mutations can be constructed in a similar way, except the arguments are not a keyword argument as typically a mutation is doing something with an input. For example</p><pre><code class="language-julia-repl hljs">julia&gt; response = mutate(client, &quot;mutation_name&quot;, Dict(&quot;new_id&quot; =&gt; 1))</code></pre><p>Unlike with <code>query</code>, the output fields are not introspected as mutations often do not have a response.</p><h3 id="Subscriptions"><a class="docs-heading-anchor" href="#Subscriptions">Subscriptions</a><a id="Subscriptions-1"></a><a class="docs-heading-anchor-permalink" href="#Subscriptions" title="Permalink"></a></h3><p>The subscriptions syntax is similar, except that we use Julia&#39;s <code>do</code> notation</p><pre><code class="language-julia hljs">open_subscription(
    client,
    &quot;subscription_name&quot;,
    sub_args=(&quot;id&quot; =&gt; 1),
    output_fields=&quot;val&quot;
) do response
    val = response.data[&quot;subscription_name&quot;][&quot;val&quot;]
    stop_sub = val == 2
    return stop_sub # If this is true, the subscription ends
end</code></pre><h2 id="Use-with-Microservices-Architectures"><a class="docs-heading-anchor" href="#Use-with-Microservices-Architectures">Use with Microservices Architectures</a><a id="Use-with-Microservices-Architectures-1"></a><a class="docs-heading-anchor-permalink" href="#Use-with-Microservices-Architectures" title="Permalink"></a></h2><p>GraphQL is often used with microservice architectures. Often, you will find that you have multiple microservices that perform the same GraphQL queries. A nice solution to this is to write a new package which wraps GraphQLClient and provides a higher-level interface, and which also handles connection to the server. For example, the <code>country</code> query above could be wrapped as follows</p><pre><code class="language-julia hljs">connect() = global_graphql_client(Client(&quot;url&quot;,&quot;ws&quot;))

function get_country(code)
    response = query(
        &quot;country&quot;,
        query_args=Dict(&quot;code&quot;=&gt;code),
        output_fields=&quot;name&quot;
    )
    return response.data[&quot;country]
end
</code></pre><p>For more information, see this JuliaCon talk</p><center>
<iframe width="560" style="height:315px" src="https://www.youtube.com/embed/KixO3udfcKA?start=1104" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="client/">Client »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Thursday 24 February 2022 08:14">Thursday 24 February 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
